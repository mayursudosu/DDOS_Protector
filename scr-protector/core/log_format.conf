# =============================================================================
# scr-protector: Custom NGINX Log Format
# =============================================================================
# This log format includes additional fields useful for security analysis.
# To use, add this to your nginx.conf http {} block.
# =============================================================================

# Enhanced log format with request timing and upstream info
log_format scr_protector '$remote_addr - $remote_user [$time_local] '
                         '"$request" $status $body_bytes_sent '
                         '"$http_referer" "$http_user_agent" '
                         'rt=$request_time '
                         'rl="$limit_req_status" '
                         'conn=$connection '
                         'reqs=$connection_requests';

# Field descriptions:
# $remote_addr           - Client IP address
# $remote_user           - Authenticated user (if any)
# $time_local            - Local time in Common Log Format
# $request               - Full request line
# $status                - Response status code
# $body_bytes_sent       - Bytes sent to client (excluding headers)
# $http_referer          - Referer header
# $http_user_agent       - User agent string
# $request_time          - Request processing time in seconds
# $limit_req_status      - Rate limit status (PASSED, DELAYED, REJECTED, etc.)
# $connection            - Connection serial number
# $connection_requests   - Number of requests on this connection

# Example usage in server block:
# access_log /var/log/nginx/access.log scr_protector;
